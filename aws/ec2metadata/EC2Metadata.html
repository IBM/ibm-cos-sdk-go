<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Struct: ec2metadata.EC2Metadata
  
    &mdash; IBM COS SDK for Go
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/highlight.github.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "aws/ec2metadata.EC2Metadata";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../package_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../aws.html" title="aws (package)">aws</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../ec2metadata.html" title="ec2metadata (package)">ec2metadata</a></span></span>
     &raquo; 
    <span class="title">EC2Metadata</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="package_list_link"
        href="../../package_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame"></iframe>

      <div id="content">
        <!--REGION_DISCLAIMER_DO_NOT_REMOVE-->
        <h1>Struct: ec2metadata.EC2Metadata
  
  
  
</h1>
<div class="package signature">
import "github.com/IBM/ibm-cos-sdk-go/aws/ec2metadata"
</div>
<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>A EC2Metadata is an EC2 Metadata service Client.</p>


  </div>
</div>
<div class="tags">
  

</div>

  <h3 class="inherited">Implemented Interfaces</h3>
  <p class="inherited"><span class='object_link'><a href="../../service/s3/s3crypto/Cipher.html" title="s3crypto.Cipher (interface)">s3crypto.Cipher</a></span></p>


  

  








  

  
    <h2>
      Constructor Functions
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#New-class_method" title="ec2metadata.EC2Metadata.New() (method)">func <strong>New</strong>(p client.ConfigProvider, cfgs ...*aws.Config) *EC2Metadata </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>New creates a new instance of the EC2Metadata client with a session.</p>
</div></span>
  
</li>


      
    </ul>
  
    <h2>
      Method  Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#Available-instance_method" title="ec2metadata.EC2Metadata.Available() (method)">func (c *EC2Metadata) <strong>Available</strong>() bool </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Available returns if the application has access to the EC2 Metadata service.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#GetDynamicData-instance_method" title="ec2metadata.EC2Metadata.GetDynamicData() (method)">func (c *EC2Metadata) <strong>GetDynamicData</strong>(p string) (string, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>GetDynamicData uses the path provided to request information from the EC2 instance metadata service for dynamic data.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#GetInstanceIdentityDocument-instance_method" title="ec2metadata.EC2Metadata.GetInstanceIdentityDocument() (method)">func (c *EC2Metadata) <strong>GetInstanceIdentityDocument</strong>() (EC2InstanceIdentityDocument, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>GetInstanceIdentityDocument retrieves an identity document describing an instance.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#GetMetadata-instance_method" title="ec2metadata.EC2Metadata.GetMetadata() (method)">func (c *EC2Metadata) <strong>GetMetadata</strong>(p string) (string, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#GetUserData-instance_method" title="ec2metadata.EC2Metadata.GetUserData() (method)">func (c *EC2Metadata) <strong>GetUserData</strong>() (string, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>GetUserData returns the userdata that was configured for the service.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#IAMInfo-instance_method" title="ec2metadata.EC2Metadata.IAMInfo() (method)">func (c *EC2Metadata) <strong>IAMInfo</strong>() (EC2IAMInfo, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>IAMInfo retrieves IAM info from the metadata API.</p>
</div></span>
  
</li>


      
        
<li class="public ">
  <span class="summary_signature"><span class='object_link'><a href="#Region-instance_method" title="ec2metadata.EC2Metadata.Region() (method)">func (c *EC2Metadata) <strong>Region</strong>() (string, error) </a></span></span>
  
  
  
  
  
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Region returns the region the instance is running in.</p>
</div></span>
  
</li>


      
    </ul>
  


  



  <div id="Function_method_details" class="method_details_list">
    <h2>Function Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="New-class_method">
  
    func <strong><span class='object_link'><a href="#New-class_method" title="ec2metadata.EC2Metadata.New() (method)">New</a></span></strong>(p <span class='object_link'><a href="../client/ConfigProvider.html" title="client.ConfigProvider (interface)">client.ConfigProvider</a></span>, cfgs ...*<span class='object_link'><a href="../Config.html" title="aws.Config (struct)">aws.Config</a></span>) *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>New creates a new instance of the EC2Metadata client with a session.
This client is safe to use across multiple goroutines.</p>

<p>Example:
    // Create a EC2Metadata client from just a session.
    svc := ec2metadata.New(mySession)</p>

<pre class="code go"><code class="go"><div class="hljs"><span class="hljs-comment">// Create a EC2Metadata client with additional configuration</span>
svc := ec2metadata.New(mySession, aws.NewConfig().WithLogLevel(aws.LogDebugHTTPBody))
</div></code></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47
48</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/service.go', line 45</span>

<div class="hljs"><span class="hljs-keyword">func</span> New(p client.ConfigProvider, cfgs ...*aws.Config) *EC2Metadata {
	c := p.ClientConfig(ServiceName, cfgs...)
	<span class="hljs-keyword">return</span> NewClient(*c.Config, c.Handlers, c.Endpo<span class="hljs-constant">int</span>, c.SigningRegion)
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
  </div>

  <div id="Method_method_details" class="method_details_list">
    <h2>Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="Available-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#Available-instance_method" title="ec2metadata.EC2Metadata.Available() (method)">Available</a></span></strong>() bool 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Available returns if the application has access to the EC2 Metadata service.
Can be used to determine if application is running within an EC2 Instance and
the metadata service is available.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 127</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) Available() <span class="hljs-constant">bool</span> {
	<span class="hljs-keyword">if</span> _, err := c.GetMetadata(<span class="hljs-string">"instance-id"</span>); err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-constant">false</span>
	}

	<span class="hljs-keyword">return</span> <span class="hljs-constant">true</span>
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GetDynamicData-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#GetDynamicData-instance_method" title="ec2metadata.EC2Metadata.GetDynamicData() (method)">GetDynamicData</a></span></strong>(p string) (string, error) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>GetDynamicData uses the path provided to request information from the EC2
instance metadata service for dynamic data. The content will be returned
as a string, or error if the request failed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56
57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 54</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) GetDynamicData(p <span class="hljs-constant">string</span>) (<span class="hljs-constant">string</span>, <span class="hljs-constant">error</span>) {
	op := &request.Operation{
		Name:       <span class="hljs-string">"GetDynamicData"</span>,
		HTTPMethod: <span class="hljs-string">"GET"</span>,
		HTTPPath:   sdkuri.PathJoin(<span class="hljs-string">"/dynamic"</span>, p),
	}

	output := &metadataOutput{}
	req := c.NewRequest(op, <span class="hljs-constant">nil</span>, output)

	<span class="hljs-keyword">return</span> output.Content, req.Send()
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GetInstanceIdentityDocument-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#GetInstanceIdentityDocument-instance_method" title="ec2metadata.EC2Metadata.GetInstanceIdentityDocument() (method)">GetInstanceIdentityDocument</a></span></strong>() (<span class='object_link'><a href="../ec2metadata.html#type-EC2InstanceIdentityDocument" title="ec2metadata (package)">EC2InstanceIdentityDocument</a></span>, error) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>GetInstanceIdentityDocument retrieves an identity document describing an
instance. Error is returned if the request fails or is unable to parse
the response.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 70</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) GetInstanceIdentityDocument() (EC2InstanceIdentityDocument, <span class="hljs-constant">error</span>) {
	resp, err := c.GetDynamicData(<span class="hljs-string">"instance-identity/document"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> EC2InstanceIdentityDocument{},
			awserr.New(<span class="hljs-string">"EC2MetadataRequestError"</span>,
				<span class="hljs-string">"failed to get EC2 instance identity document"</span>, err)
	}

	doc := EC2InstanceIdentityDocument{}
	<span class="hljs-keyword">if</span> err := json.NewDecoder(strings.NewReader(resp)).Decode(&doc); err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> EC2InstanceIdentityDocument{},
			awserr.New(<span class="hljs-string">"SerializationError"</span>,
				<span class="hljs-string">"failed to decode EC2 instance identity document"</span>, err)
	}

	<span class="hljs-keyword">return</span> doc, <span class="hljs-constant">nil</span>
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GetMetadata-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#GetMetadata-instance_method" title="ec2metadata.EC2Metadata.GetMetadata() (method)">GetMetadata</a></span></strong>(p string) (string, error) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21
22
23
24
25
26
27
28</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 17</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) GetMetadata(p <span class="hljs-constant">string</span>) (<span class="hljs-constant">string</span>, <span class="hljs-constant">error</span>) {
	op := &request.Operation{
		Name:       <span class="hljs-string">"GetMetadata"</span>,
		HTTPMethod: <span class="hljs-string">"GET"</span>,
		HTTPPath:   sdkuri.PathJoin(<span class="hljs-string">"/meta-data"</span>, p),
	}

	output := &metadataOutput{}
	req := c.NewRequest(op, <span class="hljs-constant">nil</span>, output)

	<span class="hljs-keyword">return</span> output.Content, req.Send()
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="GetUserData-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#GetUserData-instance_method" title="ec2metadata.EC2Metadata.GetUserData() (method)">GetUserData</a></span></strong>() (string, error) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>GetUserData returns the userdata that was configured for the service. If
there is no user-data setup for the EC2 instance a "NotFoundError" error
code will be returned.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 33</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) GetUserData() (<span class="hljs-constant">string</span>, <span class="hljs-constant">error</span>) {
	op := &request.Operation{
		Name:       <span class="hljs-string">"GetUserData"</span>,
		HTTPMethod: <span class="hljs-string">"GET"</span>,
		HTTPPath:   <span class="hljs-string">"/user-data"</span>,
	}

	output := &metadataOutput{}
	req := c.NewRequest(op, <span class="hljs-constant">nil</span>, output)
	req.Handlers.UnmarshalError.PushBack(<span class="hljs-keyword">func</span>(r *request.Request) {
		<span class="hljs-keyword">if</span> r.HTTPResponse.StatusCode == http.StatusNotFound {
			r.Error = awserr.New(<span class="hljs-string">"NotFoundError"</span>, <span class="hljs-string">"user-data not found"</span>, r.Error)
		}
	})

	<span class="hljs-keyword">return</span> output.Content, req.Send()
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="IAMInfo-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#IAMInfo-instance_method" title="ec2metadata.EC2Metadata.IAMInfo() (method)">IAMInfo</a></span></strong>() (<span class='object_link'><a href="../ec2metadata.html#type-EC2IAMInfo" title="ec2metadata (package)">EC2IAMInfo</a></span>, error) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>IAMInfo retrieves IAM info from the metadata API</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 89</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) IAMInfo() (EC2IAMInfo, <span class="hljs-constant">error</span>) {
	resp, err := c.GetMetadata(<span class="hljs-string">"iam/info"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> EC2IAMInfo{},
			awserr.New(<span class="hljs-string">"EC2MetadataRequestError"</span>,
				<span class="hljs-string">"failed to get EC2 IAM info"</span>, err)
	}

	info := EC2IAMInfo{}
	<span class="hljs-keyword">if</span> err := json.NewDecoder(strings.NewReader(resp)).Decode(&info); err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> EC2IAMInfo{},
			awserr.New(<span class="hljs-string">"SerializationError"</span>,
				<span class="hljs-string">"failed to decode EC2 IAM info"</span>, err)
	}

	<span class="hljs-keyword">if</span> info.Code != <span class="hljs-string">"Success"</span> {
		errMsg := fmt.Sprintf(<span class="hljs-string">"failed to get EC2 IAM Info (%s)"</span>, info.Code)
		<span class="hljs-keyword">return</span> EC2IAMInfo{},
			awserr.New(<span class="hljs-string">"EC2MetadataError"</span>, errMsg, <span class="hljs-constant">nil</span>)
	}

	<span class="hljs-keyword">return</span> info, <span class="hljs-constant">nil</span>
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Region-instance_method">
  
    func (c *<span class='object_link'><a href="" title="ec2metadata.EC2Metadata (struct)">EC2Metadata</a></span>) <strong><span class='object_link'><a href="#Region-instance_method" title="ec2metadata.EC2Metadata.Region() (method)">Region</a></span></strong>() (string, error) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Region returns the region the instance is running in.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file">// File 'aws/ec2metadata/api.go', line 114</span>

<div class="hljs"><span class="hljs-keyword">func</span> (c *EC2Metadata) Region() (<span class="hljs-constant">string</span>, <span class="hljs-constant">error</span>) {
	resp, err := c.GetMetadata(<span class="hljs-string">"placement/availability-zone"</span>)
	<span class="hljs-keyword">if</span> err != <span class="hljs-constant">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>, err
	}

	<span class="hljs-comment">// returns region without the suffix. Eg: us-west-2a becomes us-west-2</span>
	<span class="hljs-keyword">return</span> resp[:len(resp)-1], <span class="hljs-constant">nil</span>
}</div></pre>
    </td>
  </tr>
</table>

</div>
    
  </div>


      </div>

      <div id="footer">
  Generated on Fri Feb 22 10:35:12 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.5.1).
</div>

<!-- BEGIN-SECTION -->
<script type="text/javascript" src="https://media.amazonwebservices.com/amznUrchin.js"></script>
<!-- SiteCatalyst code version: H.25.2. Copyright 1996-2012 Adobe, Inc. All Rights Reserved.
More info available at http://www.omniture.com -->
<script language="JavaScript" type="text/javascript" src="https://media.amazonwebservices.com/js/sitecatalyst/s_code.min.js">
</script>
<script language="JavaScript" type="text/javascript">
  <!--
  s.prop66='AWS SDK for Go';
  s.eVar66='D=c66';
  s.prop65='API Reference';
  s.eVar65='D=c65';
  var s_code=s.t();if(s_code)document.write(s_code)
  //-->
</script>
<script language="JavaScript" type="text/javascript">
  <!--if(navigator.appVersion.indexOf('MSIE')>=0)document.write(unescape('%3C')+'\!-'+'-')
  //-->
</script>
<noscript>
  <img src="http://amazonwebservices.d2.sc.omtrdc.net/b/ss/awsamazondev/1/H.25.2--NS/0" height="1" width="1" border="0" alt="">
</noscript>
<!--/DO NOT REMOVE/-->
<!-- End SiteCatalyst code version: H.25.2. -->
<!-- END-SECTION -->

    </div>
  </body>
</html>
